%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                        Intro Générale                         %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\phantomsection 
\addcontentsline{toc}{chapter}{General introduction}
\addtocontents{toc}{\protect\addvspace{10pt}}

\vspace*{-1cm}
\begin{flushright}
\section*{\fontsize{20pt}{20pt}\selectfont\textnormal{General introduction}}
\end{flushright}
\vspace{2cm}

\lhead[\fancyplain{}{General introduction}]
      {\fancyplain{}{}}
\chead[\fancyplain{}{}]
      {\fancyplain{}{}}
\rhead[\fancyplain{}{}]
      {\fancyplain{}{General introduction}}
\lfoot[\fancyplain{}{}]%
      {\fancyplain{}{}}
\cfoot[\fancyplain{}{\thepage}]
      {\fancyplain{}{\thepage}}
\rfoot[\fancyplain{}{}]%
     {\fancyplain{}{\scriptsize}}
     

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                      Start part here                          %%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Working environment}

This doctoral thesis has been undertaken from December 2nd, 2019 to November 30th, 2022, at the LJK (Laboratoire Jean Kuntzmann for applied mathematics and informatics) in Grenoble, France. It was funded by the French National Center for Scientific Research (CNRS), as the result of a collaboration between the PPrime Institute (UPR3346, Poitiers, France), the French Cycling Federation (FFC), and the INSEP (French National Institute of Sport, Expertise and Performance), through the CREPS of Poitiers (Center for Sport Resource, Expertise, and Performance) and TSF Voiron (Springboard for Sports Training). It was later incorporated within the PerfAnalytics project, which aims to boost French sports performance towards the 2024 Olympic Games in Paris, with a particular focus on video analysis.


\section*{Context}

Currently, the analysis of sports performance is still mostly carried out by subjective visual examination. More objective approaches exist, but they are usually too complex and cumbersome to implement, or too inappropriate for in-situ analysis. Hence, coaches often find them improper for a daily usage. In order to address this issue, other methods are being developed, among which many focus on video analysis. One of the long-term objectives in this regard is to be able to fully quantify the full-body kinematics and dynamics of athletes in context, without interfering with their training or competition, in a clear and timely way, in order for coaches to be able to give them a fast, accurate, objective, and comprehensive feedback on their technique and tactics. To this end, it appeared to us that the most appropriate way would take advantage of the video streams provided by a network of calibrated cameras. Each stream would be processed by some preexisting 2D keypoint detection deep-learning models. These coordinates would then be triangulated, and finally be constrained to a biomechanically consistent full-body skeletal model. 

The original goal of this thesis shifted along the program, as it was initially mostly intended for BMX racing performance analysis (bicycle motocross.) BMX racing presented a lot of challenges which needed to be first addressed, such as the large size of the field of view, the direct sunlight, the swiftness of the movements, the occlusions of the pilot by the bike, and the lack of facilities for setting up the capture hardware. As a consequence, we first started with studying walking, running, and cycling tasks indoors, with a virtual and controlled environment map simulating an outdoor scene. We then studied boxing key performance indicators (KPIs) with lightweight consumer-grade hardware, and finally moved outdoors to investigate BMX racing.


\newpage
\section*{Content}

The thesis is organized as follows (also see the visual abstracts):

\noindent\autoref{ch:1}: Motion capture is traditionally performed with marker-based systems. However, these solutions are hardly compatible with on-field sports analysis, as they involve marker placement on the skin, and a heavy setup. As a consequence, markerless approaches are being investigated. 

\noindent\autoref{ch:2}: Sports movements don’t generally only lie in the sagittal plane, and they often cause body part occlusions. Moreover, results need to be as biomechanically coherent as possible. Hence, one of the most promising prospects for sports motion analysis consists in addressing the problem with several video sources, and then constraining 3D coordinates to a kinematic model.  Such research is at the intersection of machine learning for 2D pose estimation, computer vision for 3D reconstruction, and biomechanics for constraining coordinates to anatomically consistent kinematics. 

\noindent\autoref{ch:3}: Sport scientists would also benefit from using wireless light-weight cameras as well as a user-friendly integrated workflow. Hence, Pose2Sim, an open-source Python package striving to answer these needs, has been proposed and released \cite{Pagnon2022b}. 2D keypoint coordinates obtained with OpenPose or DeepLabCut are robustly triangulated, and serve as input for a full-body OpenSim inverse kinematics procedure (Figure~\ref{fig_visabstract1_1}).

\noindent\autoref{ch:4}: Pose2Sim robustness has been evaluated, regarding people entering and exiting the field of view, image quality, calibration errors, and low number of cameras \cite{Pagnon2021} (Figure~\ref{fig_visabstract2_1}). 

\noindent\autoref{ch:5}: Its accuracy has also been assessed, and deemed sufficient for walking, running, and cycling analysis \cite{Pagnon2022a} (Figure~\ref{fig_visabstract3_1}). 

\noindent\autoref{ch:6}: The workflow has then been tested in challenging conditions, such as shadow-boxing. Boxing involves fast, 3 dimensional, and full-body movements. These have been captured with GoPro cameras, post-calibrated on geometric cues, and post-synchronized by correlation of keypoint speeds. We concluded that boxing key performance indicators could be correctly evaluated, and that the protocol, whether it employed a full marker-based system, or a markerless one with research-grade hardware, or a markerless one with consumer-grade hardware, mattered less than the choice of a good 2D pose estimator \cite{Pagnon2022c} (Figure~\ref{fig_visabstract4_1}).  

\noindent\autoref{ch:7}: Numerous sports disciplines are practiced with special equipment, such as a board in skateboarding, a racket and a ball in tennis, or a bike in BMX racing. The interactions between the athlete and their gear are often important to retrieve. We analyzed BMX start sequences, by using OpenPose for 2D human pose estimation, and a custom trained DeepLabCut model for bike detection. We ran Pose2Sim on the joint {pilot+bike} 2D estimations, and performed 3D inverse kinematics on a custom OpenSim {pilot+bike} model. This showed that analyzing simultaneously the athlete and their equipment is possible, which provides additional perspectives for markerless sports motion analysis. 
% OpenSim model constraining handles to hands, and pedals to feet. The field was too large, and the image quality too low to obtain good results. However, we previously captured marker data of a similar scene. Keeping only markers similar to those detected by OpenPose and DeepLabCut, we were able to run the analysis. As a consequence, we hypothesize that assuming a sufficiently good image quality, it would be possible to provide joint \{bike+pilot\} kinematics to coaches. 

\begin{figure}[hbtp]
	\centering
            \def\svgwidth{1\columnwidth}
            \fontsize{10pt}{10pt}\selectfont
            \includegraphics[width=\linewidth]{"../Intro/Figures/Fig_VisAbstract1.JPG"}
            \caption{Visual abstract for the Pose2Sim workflow (\autoref{ch:3}) \cite{Pagnon2022b}.}
            \label{fig_visabstract1_1}
\end{figure}

\begin{figure}[!htp]
	\centering
	\begin{subfigure}[b]{1\textwidth}
            \centering
            \def\svgwidth{1\columnwidth}
            \fontsize{10pt}{10pt}\selectfont
            \includegraphics[width=\linewidth]{"../Intro/Figures/Fig_VisAbstract2.JPG"}
            \caption{Visual abstract for Pose2Sim robustness assessment (\autoref{ch:4}) \cite{Pagnon2021}.}
            \label{fig_visabstract2_1}
	\end{subfigure}
	\vskip 0.8cm
      \begin{subfigure}[b]{1\textwidth}
            \centering
            \def\svgwidth{1\columnwidth}
            \fontsize{10pt}{10pt}\selectfont
            \includegraphics[width=\linewidth]{"../Intro/Figures/Fig_VisAbstract3.JPG"}
            \caption{Visual abstract for Pose2Sim accuracy assessment (\autoref{ch:5}) \cite{Pagnon2022a}.}
            \label{fig_visabstract3_1}
	\end{subfigure}
      \vskip 0.8cm
	\begin{subfigure}[b]{1\textwidth}
            \centering
            \captionsetup{justification=centering}
            \def\svgwidth{1\columnwidth}
            \fontsize{10pt}{10pt}\selectfont
            \includegraphics[width=\linewidth]{"../Intro/Figures/Fig_VisAbstract4.JPG"}
            \caption{Visual abstract for the assessment of KPIs in boxing with Pose2Sim (\autoref{ch:6}) \cite{Pagnon2022c}. \\Research camera protocol: Qualisys cameras, calibration with markers, hardware synchronization. \\Action camera protocol: GoPro cameras, calibration on boxing ring dimensions, synchronization on 2D keypoint speeds.}
            \label{fig_visabstract4_1}
	\end{subfigure}
      \vskip 0.8cm
      \begin{subfigure}[b]{1\textwidth}
            \centering
            \def\svgwidth{1\columnwidth}
            \fontsize{10pt}{10pt}\selectfont
            \includegraphics[width=\linewidth]{"../Intro/Figures/Fig_VisAbstract5.JPG"}
            \caption{Visual abstract for joint analysis of the athlete with OpenPose, and their equipment with DeepLabCut (\autoref{ch:7}).}
            \label{fig_visabstract5_1}
	\end{subfigure}
	\vskip 0.8cm
	\caption{Visual abstracts for chapters 4 to 7.}
	\label{fig_visabstract}
\end{figure}


\FloatBarrier
\section*{Contributions}

This work led to the publication of a few scientific contributions as a first author: 3 peer-reviewed articles, 1 conference paper, and the release of an open-source package. Another conference paper has been published as a secondary author, and a Blender add-on integrated the published package, for 3D character animation. Moreover, another peer-reviewed article has been published as a first author during this period, although it was not related to the program.

\noindent\cite{Pagnon2021}: David Pagnon, Mathieu Domalain and Lionel Reveret. \textit{Pose2Sim: An
End-to-End Workflow for 3D Markerless Sports Kinematics—Part 1:
Robustness.} Sensors, vol. 21, no. 19, 2021.

\noindent\cite{Pagnon2022a}: David Pagnon, Mathieu Domalain and Lionel Reveret. \textit{Pose2Sim: An
End-to-End Workflow for 3D Markerless Sports Kinematics—Part 2:
Accuracy.} Sensors, vol. 22, no. 7, 2022.

\noindent\cite{Pagnon2022b}: David Pagnon, Mathieu Domalain and Lionel Reveret. \textit{Pose2Sim:
An open-source Python package for multiview markerless kinematics.}
Journal of Open Source Software, vol. 7, no. 77, page 4362, 2022.

\noindent\cite{Pagnon2022c}: 
David Pagnon, Mathieu Domalain, Thomas Robert, Bhrigu-Kumar Lahkar, Issa Moussa, Guillaume Saulière, Thibault Goyallon and Lionel Reveret. \textit{A 3D markerless protocol with action cameras – Key performance indicators in boxing.} In 2022 Congress of the European College of Sport Science (ECSS), Sevilla (Spain), 2022. Poster.

\noindent\cite{Lahkar2022a}: 
Bhrigu-Kumar Lahkar, Thibault Goyallon, Anaïs Chaumeil, David Pagnon, Issa Moussa, Andreas Muller, Mathieu Domalain, Lionel Reveret, Raphael Dumas, Thomas Robert. \textit{Assessment of a markerless motion capture system for upper extremity joint kinematics during boxing.} In 17th International Symposium on 3-D Analysis of Human Movement, Tokyo (Japan), 2022. Oral.

\noindent\cite{Barreto2022}: 
Carlos Barreto, CEB Studio. \textit{Mocap MPP2SOS} [Blender add-on], Blender Marker, 2022. \url{https://blendermarket.com/products/mocap-mpp2soss}.

\noindent\cite{Pagnon2022d}: 
David Pagnon, Germain Faity, Galo Maldonado, Yann Daout, Sidney Grosprêtre. \textit{What Makes Parkour Unique? A Narrative Review Across Miscellaneous Academic Fields.} Sports Medicine, vol. 52, page 1029, 2022.
